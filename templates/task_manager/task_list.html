{% extends "base.html" %}

{% block title %}
  <title>Tasks</title>
{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Tasks</h1>
  </div>

  {% if task_list %}
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead class="table-light">
          <tr>
            <th>Task</th>
            <th>Deadline</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for task in task_list %}
            <tr>
              <td>
                <a href="{% url 'task_manager:task-detail' task.pk %}" class="text-decoration-none">
                  {{ task.name }}
                </a>
              </td>
              <td>
                {% if task.deadline %}
                  {% if task.is_expired and not task.is_completed %}
                    <span class="text-danger">{{ task.deadline|date:"M d, Y H:i" }}</span>
                  {% else %}
                    {{ task.deadline|date:"M d, Y H:i" }}
                  {% endif %}
                {% else %}
                  <span class="text-muted">No deadline</span>
                {% endif %}
              </td>
              <td>
                {% if task.is_completed %}
                  <span class="badge bg-success">Completed</span>
                {% else %}
                  <span class="badge bg-warning text-dark">Pending</span>
                {% endif %}
              </td>
              <td>
                <a href="{% url 'task_manager:task-complete' task.pk %}" class="btn btn-sm {% if task.is_completed %}btn-danger{% else %}btn-success{% endif %}">
                  {% if task.is_completed %}
                    Discard
                  {% else %}
                    Complete
                  {% endif %}
                </a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-info">
      No tasks available. <a href="{% url 'task_manager:task-create' %}" class="alert-link">Create a new task</a>.
    </div>
  {% endif %}
{% endblock %}
